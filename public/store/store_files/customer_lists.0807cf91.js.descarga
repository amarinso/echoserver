define("modules/clipboard",["jquery"],function(t){var e,o,n;return e=function(t){var e,o;e=document.createRange(),e.selectNodeContents(t[0]),o=window.getSelection(),o.removeAllRanges(),o.addRange(e)},n=function(){var t;try{document.execCommand("copy"),t=!0}catch(e){t=!1}return t},o=function(){var t="";return window.getSelection&&(t=window.getSelection().toString()),t},{selectElement:e,copy:n,getSelection:o}}),define("modules/customer_lists",["jquery","utils/jquery_document","utils/universal_variable","modules/modals","modules/clipboard","modules/analytics"],function(t,e,o,n,a,r){"use strict";function s(e,n,a){var s,c,d=n;t.ajax({url:e,dataType:"json"}).done(function(t){for(noty({text:t.msg,type:"success"}),s=0,c=d.length;c>s;s++)d[s].remove();"undefined"!=typeof a&&r.trackEcommerceEvent(a+" - "+o.page.category)}).fail(function(t){u(t)})}function c(e,n){l=null===l?n.html():l,n.html(l),t.ajax({url:e,cache:!1,context:n,dataType:"html"}).done(function(t){this.html(t)}).fail(function(t){u(t)}),r.trackEcommerceEvent("DisplayCustomerList - "+o.page.category)}function d(e,n,a){var s=n,c=a;t.ajax(e.attr("action"),{type:e.attr("method"),data:e.serialize(),dataType:"json"}).done(function(e){var n,a=e.msg,d=e.list;"undefined"!=typeof d&&(n=s.tmpl(d).appendTo(c),n.find("input").prop("checked",!0),t("input","#xtras").val("")),r.trackEcommerceEvent("CreateCustomerList + AddProduct - "+o.page.category),noty({text:a,type:"success"})}).fail(function(t){u(t)})}function i(e,n,a){t.ajax({method:"post",dataType:"json",url:e,data:{product_to_customer_lists:{product_id:n,id:[a]}}}).done(function(t){var e=t.msg,n="add"===t.action?"AddProductToList":"RemoveProductFromList",a=t.prod_id;noty({text:e,type:"success"}),n+=" - "+o.page.category,r.trackEcommerceEvent(n,"productId: "+a)}).fail(function(t){u(t)})}function u(e,n){var a,s,c=[],d=t.parseJSON(e.responseText);try{for(a=0,s=d.errors.length;s>a;a++)c.push(d.errors[a].msg)}catch(i){c.push("Unknown error")}c.length&&(r.trackError(n+o.page.category,c.join("; ")),alert(c.join("\n")))}var l=null,p="https://www.ulabox.com/mi-cuenta/listas/";return e.on("dropdown:open",function(e,o){var n,a=t(e.target),r=t(".js-dropdown-ajax-content","#product_dropdown");"product_dropdown"===a.attr("id")&&(n=t(".js-show-customer-lists",t(o)).data("url"),"undefined"!=typeof n&&c(n,r))}).on("change",".js-list-checkbox",function(e){var o,n,a,r=t(this);o=r.is(":checked")?r.closest(".js-lists").data("url-add"):r.closest(".js-lists").data("url-remove"),n=r.closest(".js-lists").data("product-id"),a=r.val(),i(o,n,a)}).on("submit",".js-add-to-list",function(e){var o=t("#customerListTemplate"),n=t(".js-lists");d(t(this),o,n),e.preventDefault()}).on("click",".js-share-list",function(e){var o=t(e.target);p+o.data("slug")+"/"+o.data("id");n.showModals(o),e.preventDefault()}).on("click",".js-copy-list-address",function(e){a.selectElement(t("#js-list-detail-url")),a.copy(),e.preventDefault()}),{doRemove:s,displayList:c,createListAndAdd:d,addRemoveProduct:i}});